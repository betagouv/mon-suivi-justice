<h1 class='form-title'><%= t('edit_user_title') %></h1>

<%= simple_form_for @user, html: { class: 'basic-form' } do |f| %>
  <%= f.input :first_name %>
  <%= f.input :last_name %>
  <%= f.input :email, required: true %>
  <%= f.input :phone %>

  <% if current_user.admin? %>
    <%= f.association :organization, include_blank: false,
                                     label: t('activerecord.attributes.user.organization'),
                                     input_html: { class: 'form-select' } %>
  <% end %>

  <% if (current_user.admin? || current_user.local_admin?) && current_user != @user %>
    <%= f.input :role, collection: available_user_roles,
                       label_method: lambda {|k| t("activerecord.attributes.user.user_roles.#{k}")},
                       input_html: { class: 'form-select' } %>
  <% end %>

  <% if @user.cpip? && @user == current_user %>
    <%= f.input :share_phone_to_convict, as: :boolean,
                                        input_html: { class: 'form-checkbox' },
                                        label_html: { class: 'form-checkbox-label' },
                                        wrapper_html: { class: 'form-checkbox-wrapper'} %>
    <%= f.input :share_email_to_convict, as: :boolean,
                                        input_html: { class: 'form-checkbox' },
                                        label_html: { class: 'form-checkbox-label' },
                                        wrapper_html: { class: 'form-checkbox-wrapper'} %>
  <% end %>

  <% if @user.local_admin_spip? && @user.headquarter.present? %>
    <%= f.association :organization, collection: @user.headquarter.organizations, include_blank: false %>
  <% end %>

  <%= f.button :submit, t('submit') %>
<% end %>

<% if policy(:user).index? && current_user != @user %>
  <div class="text-center">
    <%= button_to t('delete'), user_path(@user),
                              data: { confirm: t('basic_confirmation') },
                              class: 'fr-btn',
                              method: :delete %>
  </div>
<% end %>
