<div class='users-container'>
  <div class='index-tools-container'>
    <div class='index-tools-filter-container'>
      <div>
        <%= select_tag '', options_from_collection_for_select(@all_users, :profile_path, 'identity'),
                           id: 'profile-search-field',
                           style: "width: 200%",
                           include_blank: true %>
      </div>
    </div>
    <div class='index-tools-controls-container'>
      <% if policy(:user).new? %>
        <%= button_to t('new_user_title'), new_user_invitation_path, class: 'link-to-new-user-button', form_class: 'link-to-new-user-form', method: :get %>
      <% end %>
    </div>
  </div>

  <div class='index-basic-table-container'>
    <div class='users-header'>
      <div class='users-header-title users-column-1'>
        <%= t('activerecord.attributes.user.name') %>
      </div>
      <div class='users-header-title users-column-2'>
        <%= t('activerecord.attributes.user.email') %>
      </div>
      <div class='users-header-title users-column-3'>
        <%= t('activerecord.attributes.user.role') %>
      </div>
      <div class='users-header-title users-column-4'>
        <%= t('activerecord.attributes.user.organization') %>
      </div>

      <div class='users-column-5'></div>
    </div>

    <% @users.each do |user| %>
      <div class='users-item-container'>
        <div class='user-data users-column-1'>
          <%= user.name %>
        </div>

        <div class='user-data users-column-2'>
          <%= user.email %>
        </div>

        <div class='user-data users-column-3'>
          <%= t("activerecord.attributes.user.user_roles.#{user.role}") %>
        </div>
        <div class='user-data users-column-4'>
          <%= user.organization.name %>
        </div>

        <div class='index-controls-container users-column-5'>
          <%= link_to t('see_profile'), user_path(user), class: 'index-control' %>

          <% if policy(:user).edit? %>
            <%= link_to t('edit'), edit_user_path(user), class: 'index-control' %>
          <% end %>

          <% if policy(:user).destroy? %>
            <% if !user.admin? %>
              <%= link_to t('delete'), user_path(user),
                                       data: { confirm: t('basic_confirmation') },
                                       class: 'index-control',
                                       method: :delete %>
            <% else %>
              <% if current_user.admin? %>
                <%= link_to t('delete'), user_path(user),
                                         data: { confirm: t('basic_confirmation') },
                                         class: 'index-control',
                                         method: :delete %>
              <% end %>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>

    <%= paginate @users %>
  </div>
</div>
